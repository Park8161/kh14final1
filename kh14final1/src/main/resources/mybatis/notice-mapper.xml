<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="notice">

	<select id="search" resultType="NoticeDto">
		select * from notice where
		instr(${column), #{keyword}) > 0
	</select>
	
	<!-- 조건을 이용하여 list와 search 합체 -->
	<select id="listSearch" resultType="NoticeDto">
		select * from notice
		<if test="column != null and keyword != null">
			where instr(${column}, #{keyword}) > 0
		</if>
	</select>
	
	<!-- 등록(관리자만) -->
	<select id="sequence" resultType="int">
		select notice_seq.nextval from dual
	</select>
	<insert id="insert">
		insert into notice(
			notice_no, notice_writer, notice_title, notice_content
			) values(
				#{noticeNo}, #{noticeWriter}, #{noticeTitle}, #{noticeContent}
			)
	</insert>
	
	<!-- 목록 -->
	<select id="list" resultType="NoticeDto">
		select * from notice order by notice_no asc
	</select>
	
	
	<!-- 상세 -->
	<select id="detail" resultType="NoticeDto">
		select * from notice where notice_no = #{noticeNo}
	</select>
	
	<!-- 수정(관리자만) -->
	<update id= "edit">
		update notice
		set notice_type = #{noticeType}, notice_title = #{noticeTitle},
			notice_content = #{noticeContent}
		where notice_no = #{noticeNo}
	</update>
	
	<!-- 삭제 -->
	<delete id="delete">
		delete notice where notice_no = #{noticeNo}
	</delete>
	
	<!-- 검색 -->
	<select id="countByPaging" resultType="int">
        <if test="search">
            select count(*) from notice where instr(${column}, #{keyword}) > 0
        </if>
        <if test="!search">
            select count(*) from notice
        </if>
    </select>
    
	
	<!-- 공지사항 목록 카운트 -->
	<select id="count" resultType="int">
	    select count(*) from notice 
	    <if test="column != null and keyword != null">
	        where instr(${column}, #{keyword}) > 0 
	    </if>
	</select>
	
</mapper>